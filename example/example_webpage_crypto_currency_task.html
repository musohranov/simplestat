<html>
<head>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script type="text/javascript">

google.load('visualization', 'current', {packages: ['controls']});
google.setOnLoadCallback(drawChart);

function drawChart () {
    var jsonData = $.ajax({
        url: "./crypto_currency",
        dataType: "json",
        async: false
    }).responseText;

    var chartData = new google.visualization.DataTable();

    chartData.addColumn('datetime', 'Время');

    
    chartData.addColumn('number', 'Bitcoin');
    
    chartData.addColumn('number', 'Ethereum');
    
    chartData.addColumn('number', 'Monero');
    
    chartData.addColumn('number', 'BitcoinCash');
    
    chartData.addColumn('number', 'BitcoinGold');
    
    chartData.addColumn('number', 'CARDANO');
    
    chartData.addColumn('number', 'DASH');
    
    chartData.addColumn('number', 'EOS');
    
    chartData.addColumn('number', 'IOTA');
    
    chartData.addColumn('number', 'NEM');
    
    chartData.addColumn('number', 'NEO');
    
    chartData.addColumn('number', 'OmiseGo');
    
    chartData.addColumn('number', 'Ripple');
    

    chartData.addRows([
       [new Date('2020-02-05 00:14:36.940035'), 9187.26, 188.39, 74.816, 379.33, 11.3, 0.05609, 110.98, 4.153, 0.3304, 0.04727, 12.265, 0.974, 0.26605],  [new Date('2020-02-05 00:15:12.561403'), 9188.51, 188.42, 74.816, 379.52, 11.302, 0.05616, 110.98, 4.154, 0.33035, 0.04728, 12.263, 0.974, 0.26596],  [new Date('2020-02-05 00:15:48.055856'), 9188.51, 188.325, 74.816, 379.53, 11.302, 0.0561, 110.98, 4.151, 0.33035, 0.04728, 12.258, 0.974, 0.26586],  [new Date('2020-02-05 00:16:23.790495'), 9188.76, 188.39, 74.912, 379.53, 11.302, 0.05609, 110.98, 4.152, 0.33035, 0.04733, 12.256, 0.974, 0.2659],  [new Date('2020-02-05 00:17:03.367016'), 9187.51, 188.315, 74.816, 379.4, 11.301, 0.05608, 111.0, 4.151, 0.33035, 0.04727, 12.255, 0.973, 0.26584],  [new Date('2020-02-05 00:17:38.969361'), 9187.76, 188.31, 74.821, 379.35, 11.3, 0.05616, 111.01, 4.153, 0.3304, 0.04727, 12.251, 0.973, 0.26596],  [new Date('2020-02-05 00:18:15.018799'), 9187.66, 188.32, 74.816, 379.37, 11.301, 0.05625, 111.01, 4.154, 0.3304, 0.04727, 12.251, 0.973, 0.26592],  [new Date('2020-02-05 00:18:50.370937'), 9188.41, 188.47, 74.801, 379.89, 11.302, 0.05627, 111.07, 4.159, 0.3305, 0.04728, 12.257, 0.973, 0.26602],  [new Date('2020-02-05 00:19:25.992873'), 9184.51, 188.28, 74.801, 379.47, 11.296, 0.05627, 111.08, 4.157, 0.33055, 0.0473, 12.244, 0.973, 0.26565],  [new Date('2020-02-05 00:20:18.166037'), 9184.51, 188.305, 74.791, 379.34, 11.296, 0.05624, 111.01, 4.155, 0.3305, 0.0473, 12.241, 0.973, 0.26543],  [new Date('2020-02-05 00:20:53.509930'), 9181.23, 188.295, 74.801, 379.29, 11.293, 0.05625, 111.01, 4.153, 0.3304, 0.04729, 12.234, 0.973, 0.26525],  [new Date('2020-02-05 00:21:28.714656'), 9181.23, 188.225, 74.801, 379.4, 11.293, 0.05625, 111.0, 4.151, 0.33045, 0.04729, 12.225, 0.973, 0.26527],  [new Date('2020-02-05 00:22:04.748288'), 9180.71, 188.15, 74.776, 378.76, 11.292, 0.05625, 111.01, 4.149, 0.3304, 0.04728, 12.219, 0.973, 0.26516],  [new Date('2020-02-05 00:22:39.822864'), 9179.41, 188.15, 74.776, 378.67, 11.291, 0.05624, 111.01, 4.147, 0.3304, 0.04727, 12.231, 0.973, 0.26531],  [new Date('2020-02-05 00:23:15.252837'), 9181.16, 188.13, 74.741, 378.7, 11.293, 0.05623, 111.05, 4.149, 0.3304, 0.04724, 12.23, 0.973, 0.26541],  [new Date('2020-02-05 00:23:51.032604'), 9179.26, 188.125, 74.736, 378.66, 11.29, 0.05622, 111.02, 4.149, 0.3311, 0.04728, 12.222, 0.973, 0.26538],  [new Date('2020-02-05 00:24:26.197350'), 9180.78, 188.193, 74.746, 378.99, 11.293, 0.05614, 111.04, 4.15, 0.33145, 0.04729, 12.214, 0.973, 0.26547],  [new Date('2020-02-05 00:25:02.557048'), 9183.16, 188.315, 74.736, 379.1, 11.296, 0.05616, 111.04, 4.152, 0.33175, 0.04729, 12.219, 0.971, 0.26592],  [new Date('2020-02-05 00:25:38.346263'), 9181.53, 188.24, 74.686, 379.02, 11.293, 0.05616, 111.02, 4.149, 0.3317, 0.04733, 12.217, 0.973, 0.26583],  [new Date('2020-02-05 00:26:13.711696'), 9179.56, 188.165, 74.676, 378.92, 11.291, 0.05615, 111.0, 4.149, 0.3318, 0.04733, 12.217, 0.973, 0.26595],  [new Date('2020-02-05 00:26:50.029155'), 9181.68, 188.2, 74.696, 378.96, 11.293, 0.05621, 111.0, 4.152, 0.33115, 0.04733, 12.212, 0.971, 0.26609],  [new Date('2020-02-05 00:27:25.576327'), 9182.01, 188.25, 74.567, 379.16, 11.34, 0.05624, 111.04, 4.153, 0.3311, 0.04733, 12.217, 0.973, 0.26618],  [new Date('2020-02-05 00:28:22.491148'), 9182.01, 188.2, 74.567, 378.89, 11.34, 0.05624, 110.98, 4.15, 0.3309, 0.04733, 12.217, 0.974, 0.26617],  [new Date('2020-02-05 00:28:58.072059'), 9181.76, 188.19, 74.567, 378.88, 11.34, 0.05623, 111.01, 4.149, 0.33105, 0.04733, 12.216, 0.973, 0.26588],  [new Date('2020-02-05 00:29:33.537084'), 9183.13, 188.17, 74.567, 378.88, 11.341, 0.05619, 111.02, 4.151, 0.33095, 0.04734, 12.216, 0.973, 0.26587],  [new Date('2020-02-05 00:30:09.195999'), 9183.13, 188.17, 74.567, 378.88, 11.341, 0.05618, 111.03, 4.15, 0.33105, 0.04734, 12.215, 0.973, 0.26589],  [new Date('2020-02-05 00:30:44.618517'), 9183.13, 188.205, 74.567, 378.96, 11.341, 0.05617, 111.03, 4.151, 0.3312, 0.04734, 12.219, 0.973, 0.26602],  [new Date('2020-02-05 00:31:20.711764'), 9181.26, 188.145, 74.567, 378.8, 11.339, 0.05613, 111.0, 4.15, 0.33135, 0.04734, 12.22, 0.973, 0.26594],  [new Date('2020-02-05 00:31:56.664659'), 9183.88, 188.195, 74.741, 378.95, 11.342, 0.05609, 111.02, 4.15, 0.33135, 0.04735, 12.22, 0.973, 0.26596],  [new Date('2020-02-05 00:32:32.975393'), 9181.76, 188.065, 74.801, 378.59, 11.34, 0.05609, 111.02, 4.148, 0.3315, 0.04733, 12.22, 0.973, 0.26588],  [new Date('2020-02-05 00:33:08.179673'), 9185.51, 188.165, 74.821, 378.82, 11.343, 0.05616, 111.02, 4.15, 0.3316, 0.04735, 12.256, 0.975, 0.26595],  [new Date('2020-02-05 00:33:43.981089'), 9183.88, 188.18, 74.816, 378.93, 11.343, 0.05615, 111.03, 4.148, 0.33175, 0.04735, 12.237, 0.973, 0.26592],  [new Date('2020-02-05 00:34:21.577690'), 9183.13, 188.145, 74.821, 379.1, 11.342, 0.05615, 111.03, 4.15, 0.33235, 0.04735, 12.239, 0.975, 0.26594],  [new Date('2020-02-05 00:34:59.122402'), 9183.63, 188.145, 74.82, 379.15, 11.342, 0.05615, 111.03, 4.149, 0.33235, 0.04734, 12.242, 0.975, 0.26566],  [new Date('2020-02-05 00:35:34.975846'), 9186.38, 188.23, 74.845, 379.34, 11.346, 0.05612, 111.04, 4.152, 0.33225, 0.04736, 12.247, 0.973, 0.26572],  [new Date('2020-02-05 00:36:10.454443'), 9188.36, 188.25, 74.86, 379.34, 11.348, 0.05613, 111.02, 4.154, 0.33225, 0.04737, 12.254, 0.973, 0.26565],  [new Date('2020-02-05 00:36:46.075151'), 9183.38, 188.08, 74.85, 378.96, 11.342, 0.05611, 110.98, 4.15, 0.333, 0.04734, 12.227, 0.973, 0.26542],  [new Date('2020-02-05 00:37:22.043326'), 9186.51, 188.165, 74.875, 379.0, 11.347, 0.05611, 111.0, 4.151, 0.333, 0.04745, 12.223, 0.973, 0.26535],  [new Date('2020-02-05 00:37:58.992006'), 9186.08, 188.135, 74.865, 379.0, 11.345, 0.0561, 111.0, 4.15, 0.333, 0.04745, 12.223, 0.973, 0.26536],  [new Date('2020-02-05 00:38:37.067107'), 9186.58, 188.17, 74.875, 379.0, 11.346, 0.05609, 111.0, 4.151, 0.33235, 0.04745, 12.218, 0.973, 0.26523],  [new Date('2020-02-05 00:39:14.749891'), 9186.83, 188.155, 74.88, 378.86, 11.348, 0.05609, 111.01, 4.153, 0.3335, 0.04746, 12.219, 0.974, 0.26531],  [new Date('2020-02-05 00:39:52.904782'), 9188.13, 188.193, 74.93, 379.0, 11.348, 0.0561, 111.02, 4.153, 0.3336, 0.04746, 12.218, 0.974, 0.2654],  [new Date('2020-02-05 00:40:30.815873'), 9184.26, 188.1, 74.93, 378.67, 11.346, 0.05608, 110.94, 4.151, 0.3337, 0.04745, 12.22, 0.974, 0.26533],  [new Date('2020-02-05 00:41:09.234591'), 9186.26, 188.113, 75.0, 378.92, 11.346, 0.05608, 110.95, 4.151, 0.33395, 0.04754, 12.22, 0.974, 0.26523],  [new Date('2020-02-05 00:41:47.163709'), 9186.51, 188.098, 75.005, 378.92, 11.346, 0.05607, 110.95, 4.151, 0.33405, 0.04754, 12.212, 0.974, 0.26523],  [new Date('2020-02-05 00:42:25.166749'), 9184.76, 188.14, 75.01, 378.52, 11.344, 0.05605, 110.95, 4.151, 0.3337, 0.04753, 12.177, 0.974, 0.26514],  [new Date('2020-02-05 00:43:03.368740'), 9187.01, 188.155, 75.005, 378.92, 11.347, 0.05603, 110.97, 4.153, 0.3339, 0.04755, 12.185, 0.974, 0.26492],  [new Date('2020-02-05 00:43:41.355956'), 9188.63, 188.175, 75.0, 378.92, 11.348, 0.05596, 110.96, 4.153, 0.334, 0.04755, 12.187, 0.974, 0.26492],  [new Date('2020-02-05 00:44:20.254780'), 9189.13, 188.215, 75.01, 378.99, 11.35, 0.05596, 110.97, 4.154, 0.3341, 0.04755, 12.189, 0.974, 0.26494],  [new Date('2020-02-05 00:44:59.077765'), 9189.88, 188.4, 75.01, 378.94, 11.35, 0.05596, 110.99, 4.154, 0.334, 0.04756, 12.191, 0.974, 0.265],  [new Date('2020-02-05 00:45:37.680309'), 9188.51, 188.44, 75.03, 378.94, 11.349, 0.05599, 111.0, 4.156, 0.3341, 0.04755, 12.186, 0.973, 0.26492],  [new Date('2020-02-05 00:46:16.949474'), 9188.66, 188.42, 75.09, 378.94, 11.349, 0.05599, 111.0, 4.155, 0.3337, 0.04755, 12.177, 0.973, 0.26496],  [new Date('2020-02-05 00:46:55.674776'), 9189.63, 188.46, 75.15, 379.0, 11.351, 0.05602, 111.0, 4.155, 0.3337, 0.04756, 12.178, 0.974, 0.26522],  [new Date('2020-02-05 00:47:34.679538'), 9189.51, 188.49, 75.255, 379.01, 11.35, 0.05602, 111.0, 4.155, 0.33295, 0.04756, 12.177, 0.974, 0.26502],  [new Date('2020-02-05 00:48:13.507071'), 9188.51, 188.515, 75.255, 379.01, 11.348, 0.05601, 111.0, 4.154, 0.33295, 0.04755, 12.177, 0.974, 0.26521],  [new Date('2020-02-05 00:48:52.961260'), 9187.71, 188.575, 75.225, 379.01, 11.348, 0.05601, 110.98, 4.156, 0.33285, 0.04755, 12.178, 0.974, 0.26524],  [new Date('2020-02-05 00:49:31.382956'), 9186.33, 188.5, 75.235, 378.82, 11.344, 0.05601, 111.0, 4.152, 0.3329, 0.04752, 12.178, 0.977, 0.26509],  [new Date('2020-02-05 00:50:09.840875'), 9183.26, 188.465, 75.165, 378.88, 11.342, 0.056, 110.96, 4.149, 0.3331, 0.04753, 12.179, 0.977, 0.2651],  [new Date('2020-02-05 00:50:48.443735'), 9185.71, 188.57, 75.13, 378.91, 11.345, 0.056, 111.0, 4.15, 0.3338, 0.04759, 12.171, 0.974, 0.26506],  [new Date('2020-02-05 00:51:27.455817'), 9184.21, 188.485, 75.095, 378.89, 11.344, 0.05599, 111.0, 4.149, 0.3338, 0.04762, 12.171, 0.974, 0.26485],  [new Date('2020-02-05 00:52:06.460032'), 9184.46, 188.38, 75.095, 378.89, 11.343, 0.05599, 110.95, 4.15, 0.334, 0.04776, 12.169, 0.974, 0.26483],  [new Date('2020-02-05 00:52:45.033836'), 9183.96, 188.325, 75.13, 378.89, 11.344, 0.05599, 110.93, 4.148, 0.33405, 0.04785, 12.157, 0.974, 0.26455], 
    ]);

    var chart = new google.visualization.ChartWrapper({
        chartType: 'AnnotationChart',
        containerId: 'chart',
        dataTable: chartData,
        options: {
            width: 1024,
            height: 768,
            displayAnnotations: true,
        }
    });

    var filterData = new google.visualization.DataTable();
    filterData.addColumn('number', 'colIndex');
    filterData.addColumn('string', 'colLabel');
    for (var i = 1; i < chartData.getNumberOfColumns(); i++) {
        filterData.addRow([i, chartData.getColumnLabel(i)]);
    }

    var filter = new google.visualization.ControlWrapper({
        controlType: 'CategoryFilter',
        containerId: 'column_filter',
        dataTable: filterData,
        options: {
            filterColumnLabel: 'colLabel',
            ui: {
                label: 'Колонки',
                allowTyping: false,
                allowMultiple: true,
                allowNone: false,
                selectedValuesLayout: 'belowStacked'
            }
        },
        state: {selectedValues: [chartData.getColumnLabel(1)]}
    });

    function setChartView () {
        var columns = [0];

        filter.getState().selectedValues.forEach(function(selectedValue) {
            var row = filterData.getFilteredRows([{column: 1, value: selectedValue}])[0];
            columns.push(filterData.getValue(row, 0));
        });

        chart.setView({
            columns: columns
        });
        chart.draw();
    }

    setChartView();

    filter.draw();
    google.visualization.events.addListener(filter, 'statechange', setChartView);
}
  </script>
</head>
<body>
<div id="column_filter"></div>
<div id="chart"></div>
</body>
</html>